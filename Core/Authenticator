<?php
namespace Core;

class Authenticator
{
public function auth($email,$password){
$user = App::resolve(\Core\database::class)->query("select * from user where email = :email",[
    'email'=>$email
])->find();

if($user && password_verify($password,$user['password'])){
    $this->login([
        'email'=>$email,
    ]);
    return true;
}
return false;
}

public function login($user){
    $_SESSION['user'] = [
        'email'=>$user['email'],
    ];
    session_regenerate_id(true);
}

}